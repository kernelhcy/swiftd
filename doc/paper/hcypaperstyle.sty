% hcy毕业设计论文模板
% id : hcy@bmy 
% email : huangcongyu2006@gmail.com
% 按照《本科毕业设计（论文）工作手册》要求设计。

\ProvidesPackage{hcypaperstyle}

%设置字体。
\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}

\usepackage{hyperref}

%插入图片
\usepackage{graphicx}
%用如下形式插入图片
%\begin{figure}[htbp]
%\centering
%\caption{测试图片}
%\includegraphics[height=5cm, width=16cm]{test.eps}
%\end{figure}

%设置页边距。
%上、下、左、右、装订线的页边距：3.0cm, 2.5cm, 2.6cm, 2.6cm, 0cm
\usepackage[top=3cm, bottom=2.5cm, left=2.5cm, right=2.5cm,% 
	headsep=1.2cm,footskip=0.75cm,%
	twoside,a4paper]{geometry}

%中英混排
\usepackage{xeCJK}
\setCJKfamilyfont{tt}{SimSun}
\setmainfont{Times New Roman} 		%默认字体，默认英文字体。
\setCJKmainfont{SimSun}				%中文默认字体
\CJKsetecglue{}						%中英间隔

%字体大小
\newcommand{\ltwo}{\fontsize{18pt}{27pt}\selectfont} 		%小二
\newcommand{\three}{\fontsize{16pt}{24pt}\selectfont}		%三号
\newcommand{\lthree}{\fontsize{15pt}{22.5pt}\selectfont}	%小三
\newcommand{\four}{\fontsize{14pt}{21pt}\selectfont}		%四号
\newcommand{\lfour}{\fontsize{12pt}{18pt}\selectfont}		%小四
\newcommand{\five}{\fontsize{10.5pt}{15.75pt}\selectfont}	%五号
\newcommand{\lfive}{\fontsize{9pt}{13.5pt}\selectfont}		%小五

%字体命令
\newcommand{\song}{\fontspec{SimSun}}
%\newcommand{\kai}{\fontspec{KaiTi}}
%\newcommand{\cp}{\fontspec{Courier 10 Pitch}}
\newcommand{\cn}{\fontspec{Courier New}}
\newcommand{\tnr}{\fontspec{Times New Roman}}

\XeTeXlinebreaklocale "zh"  % 表示用中文的断行
\XeTeXlinebreakskip = 0pt plus 1pt % 多一点调整的空间

%%摘要格式
%中文格式
\newcommand{\zhabstract}{\chapter*{摘\quad 要} \chaptermark{摘\quad 要}}
\newcommand{\zhkeywords}{~\\\hspace{-2em} \five\textbf{关键字：}}
%英文格式
\newcommand{\enabstract}{\chapter*{ABSTRACT}\chaptermark{ABSTRACT}}
\newcommand{\enkeywords}{~\\\hspace{-2em} \five\textbf{KEY WORDS: }}

%1.2倍行距
\linespread{1}

%段落首行缩进
\makeatletter
\let\@afterindentfalse\@afterindenttrue
\@afterindenttrue
\makeatother
\setlength{\parindent}{2em}


%缩小列表的行距
\usepackage{paralist}
\let\itemize\compactitem
\let\enditemize\endcompactitem
\let\enumerate\compactenum
\let\endenumerate\endcompactenum
\let\description\compactdesc
\let\enddescription\endcompactdesc
%列表缩进
\setdefaultleftmargin{3.5em}{3.5em}{3.5em}{2em}{2em}{2em}

%标题格式
\usepackage[raggedleft]{titlesec}
\titleformat{\chapter}{\center \three \bf}{\thechapter{}}{1em}{}
\titleformat{\section}{\lthree \bf}{\thesection}{1em}{}
\titleformat{\subsection}{\four \bf}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\four \bf}{\thesubsubsection}{1em}{}
\titlespacing{\section}{0em}{*4}{*2}
\titlespacing{\subsection}{2em}{*2}{*1}
\titlespacing{\subsubsection}{4em}{*1}{*1}


%目录格式
\usepackage{titletoc}
%\dottedcontents{chapter}[0em]{}{1em}{0.5pc}
%\dottedcontents{section}[1em]{}{2em}{0.5pc}
%\dottedcontents{subsection}[2em]{}{3em}{0.5pc}
\titlecontents{chapter}[0em]{\rm\vspace{0.3\baselineskip}}{\rm\thecontentslabel\quad}{}{\titlerule*[1pc]{\ldots}\rm\contentspage}
\titlecontents{section}[0.5em]{\rm}{\rm\thecontentslabel\quad}{}{\titlerule*[1pc]{\ldots}\rm\contentspage}
\titlecontents{subsection}[1em]{\rm}{\rm\thecontentslabel\quad}{}{\titlerule*[1pc]{\ldots}\rm\contentspage}


\renewcommand {\today}{\number\year 年\number\month 月\number\day 日}

\renewcommand {\contentsname}{目\quad 录}

\usepackage[title,titletoc,header]{appendix}
\renewcommand {\appendixname}{附\quad 录}
\renewcommand {\appendixtocname}{附\quad 录}
\renewcommand {\appendixpagename}{附\quad 录}
%\newcommand{\myappendix}{\chapter*{附\quad 录：\quad 外文资料翻译} \chaptermark{附\quad 录}}
\renewcommand {\bibname}{参考文献}%report和book是bibname，article是refname。

%图，表标题的间距。
\setlength{\abovecaptionskip}{0pt}
\setlength{\belowcaptionskip}{10pt}

\renewcommand {\figurename}{\five 图}
\renewcommand {\thefigure}{\arabic{section}-\arabic{figure}}

\renewcommand {\tablename}{\five 表}
\renewcommand {\thetable}{\arabic{section}-\arabic{table}}
\usepackage{booktabs}
\renewcommand {\heavyrulewidth}{1.5pt}	%表格外线宽
\renewcommand {\lightrulewidth}{1pt}	%表格内线宽
%用如下形式插入三线表
%\begin{table}[htbp]
%\setlength{\abovecaptionskip}{0pt} %设置标题上下的宽度。图片也一样 
%\setlength{\belowcaptionskip}{10pt} 
%\caption{表格测试}
%\centering
%\begin{tabularx}{\textwidth}{XXXXl} %最后一列是空的。这样可以是倒数第二列居中，否则会报错或不居中。
%\toprule
%\centering 名称 & \centering  模块1 & \centering  模块2 &\centering 模块3&\\
%\midrule
%\centering PLUGIN\_FUNC\_UNSET &\centering  p1 &\centering  p2 &\centering  p3&\\
%\centering PLUGIN\_URI\_CLEAN &\centering  p1 &\centering  p2 &\centering  p3&\\
%\bottomrule
%\end{tabularx}
%\end{table}

\usepackage{fancyhdr}	%页眉页脚
\pagestyle{fancy}
%\renewcommand{\sectionmark}[1]{\markboth{第\thesection 章\quad #1}{}}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\fancyhf{}
\makeatletter %双线页眉

%章节首页加上页眉
\renewcommand\chapter{\if@openright\cleardoublepage\else\clearpage\fi
                   \thispagestyle{fancy}%！注意，就是这一行决定了首页不要页眉！
                   \global\@topnum\z@
                   \@afterindentfalse
                   \secdef\@chapter\@schapter}

\def\headrule{{\if@fancyplain\let\headrulewidth\plainheadrulewidth\fi%
	\hrule\@height 1.0pt \@width\headwidth\vskip1.0pt%
		  \hrule\@height 1.0pt\@width\headwidth%
		   \vskip-2\headrulewidth\vskip-1pt}}%\vspace{1cm}}
\makeatother

\setlength{\headheight}{15pt}
\fancyhead[EC]{\lfive 西安交通大学本科生毕业设计（论文）}
\fancyhead[OC]{\lfive \leftmark}
\fancyfoot[EL,OR]{\lfive\thepage} %奇数页页码在右下脚

\usepackage{fancyvrb}	%代码环境
\DefineVerbatimEnvironment{verbatim}{Verbatim} {frame=single, baselinestretch=1, xleftmargin=5pt, xrightmargin=5pt, fontsize=\five}

\usepackage{indentfirst,cite,tabularx}
\newcommand{\ucite}[1]{$^{\mbox{\scriptsize \cite{#1}}}$}	%参考文献上标

    %Define a new command \ucite to generate upper-script (i.e., superscript) cite.
	% It is only for paragraph mode. By PENG Zhaowang on July 15, 1999
	% Note: the command \cite generates in-text citation, not superscript one.

