digraph state 
{
  edge [color=green];
  connect -> requeststart -> read -> requestend -> handlerequest -> responsestart -> write -> responseend -> connect;
  edge [color=grey];
  requestend -> readpost -> handlerequest [ label="POST" ];
  edge [ color=blue]
  responseend -> requeststart [ label="keep-alive" ];
  edge [ color=lightblue]
  handlerequest -> handlerequest [ label="subrequest" ];
  edge [style=dashed, color=red];
  error -> close [ label="server close" ];
  close -> connect;
  error -> connect [ label="client close" ];
  handlerequest -> error;
  read -> error;
  readpost -> error;
  write -> error;
  connect [shape=box];
}
